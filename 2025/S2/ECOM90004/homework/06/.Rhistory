library(tidyverse)
library(lubridate)
library(janitor)
library(forecast)
theme_set(theme_minimal())
dt <- read.csv("RetailSales.csv")
Retail_m <- ts(dt$Total, frequency=12, start=c(1982,4), end=c(2024,9))
logRetailSales <- window(log(aggregate(Retail_m, nfrequency=4)),
start=c(2000,1), end=c(2018,4))
n <- length(logRetailSales)
hist(tADF, breaks=30, freq=FALSE, xlim=c(-6,3))
library(urca)
set.seed(42)
p <- 1
t <- (p+1):n
reps <- 1000
tADF <- matrix(nrow=reps, ncol=1)
for (r in 1:reps){
# Random drawing from ARIMA(0,1,0) model
Y <- arima.sim(n=n, model=list(order=c(0,1,0)))[-1]
# ADF testing equation with linear trend
DY <- Y[t]-Y[t-1]
Y1 <- Y[t-1]
tADF[r] <- summary(lm(DY~Y1+t))$coefficients["Y1","t value"]
}
hist(tADF, breaks=30, freq=FALSE, xlim=c(-6,3))
x <- seq(from=-6, to=3, by=0.1)
lines(x, dnorm(x), col="red", lwd=2)
print(cv_sim)
hist(tADF, breaks=30, freq=FALSE, xlim=c(-6,3))
x <- seq(from=-6, to=3, by=0.1)
lines(x, dnorm(x), col="red", lwd=2)
print(pval)
library(urca)
library(forecast)
print(pval)
